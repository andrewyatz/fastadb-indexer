swagger: '2.0'
info:
  description: System for retrieving sequence and metadata concerning a reference sequence object by hash identifiers
  version: '0.1'
  title: GA4GH Reference Sequence Retrieval API

#host: www.ebi.ac.uk/ena/cram/sequence
host: seqapi.herokuapp.com
schemes:
 - https
 - http

paths:
  "/service-info":
    get:
      summary: Retrieve a summary of features this API deployment supports
      produces:
        - application/json
      tags:
        - Services
      responses:
        '200':
          description: Display of all known configurations for a service deployment
          schema:
            $ref: '#/definitions/ServiceInfo'
        '406':
          $ref: '#/responses/BadFormat'
  /ping:
    get:
      summary: Return a ping text indicating the service is up
      produces:
        - plain/text
      tags:
        - Services
      responses:
        '200':
          description: Display a ping message
        '406':
          $ref: '#/responses/BadFormat'
  /sequence/{id}:
    get:
      summary: Get a sequence from a hash
      operationId: sequence
      description: |
        Retrieve a reference sequence using a hash function
      produces:
      - text/plain
      tags:
      - Sequence
      parameters:
      - in: path
        name: id
        description: The identifier to use. Should be a checksum hash identifier
        required: true
        type: string
        default: "6681ac2f62509cfc220d78751b8dc524"
      - in: query
        name: start
        description: Request a subsequence of the data (0-based)
        type: integer
        format: int32
        minimum: 0
      - in: query
        name: end
        description: Request a subsequence of the data by specifying the end
        type: integer
        format: int32
        minimum: 1
      - in : header
        name: Range
        required: false
        description: "Specify a substring as a range not using query parameters. Note start is in Ensembl-style start coordinates i.e. the first base of a sequence is 1 not 0 as in the start parameter. Example is 'bytes: 1-10'"
        type: string

      responses:
        200:
          description: Successful retrieval of sequence. Returned as a single string with no line breaks
          schema:
            type: string
            example: MSSPTPPGGQRTLQKRKQGSSQKVAASAPKKNTNSNNSILKIYSDEATGLRVDPLVVLFLAVGFIFSVVALHVISKVAGKLF
        '400':
          description: Invalid input; normally due to range parameter usage
        '404':
          description: Sequence was not found
        '406':
          $ref: '#/responses/BadFormat'
        '416':
          description: Invalid range request specified

  /sequence/{id}/metadata :
    get:
      summary: Get reference metadata from a hash
      description: Retrieve a metadata about a reference sequence using a hash identifier
      produces:
        - application/json
      tags:
        - Metadata
      parameters:
        - in: path
          name: id
          type: string
          default: "6681ac2f62509cfc220d78751b8dc524"
          required: true
          description: The identifier to use. Should be a checksum hash
      responses:
        '200':
          description: Successful retrieval of sequence metadata
          schema:
            $ref: '#/definitions/Metadata'
        '404':
          description: Sequence hash was not found
        '406':
          $ref: '#/responses/BadFormat'

definitions:
  Metadata:
    type: object
    properties:
      id:
        type: string
        description: Query identifier. Normally the default checksum for a given service
        example: 6681ac2f62509cfc220d78751b8dc524
      md5:
        type: string
        description: MD5 checksum of the reference sequence
        example: 6681ac2f62509cfc220d78751b8dc524
      trunc512:
        type: string
        description: Truncated, to 48 characters, SHA-512 checksum of the reference sequence encoded as a HEX string
        example: 959cb1883fc1ca9ae1394ceb475a356ead1ecceff5824ae7
      length:
        type: integer
        format: int64
        description: An decimal integer of the length of the reference sequence
      aliases:
        type: array
        items:
          $ref: '#/definitions/Alias'
    required:
    - id
    - length
    - md5
    - aliases
  Alias:
    type: object
    properties:
      alias:
        type: string
        description: Free text alias for a given sequence
        example: chr1, CM000663.2
      naming_authority:
        type: string
        description: Name of the authority, which issued the given alias
    required:
      - alias
      - naming_authority
  ServiceInfo:
    type: object
    properties:
      supported_api_versions:
        type: array
        items:
          type: string
          description: Supported versions by this API
          example: 0.1
      circular_locations:
        type: boolean
        description: Indicates if the service supports circular location queries
    required:
        - supported_api_versions
        - circular_locations

responses:
  BadFormat:
    description: The requested data format is not supported by the endpoint
  NotFound:
    description: The requested resource was not found